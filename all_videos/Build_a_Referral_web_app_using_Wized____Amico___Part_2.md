In this video, we're going to learn how to build a referral program using WISD. Right. Let's quickly explain what a referral program is and how it works. Basically, each user that joins the platform gets a unique link that they can share with other users. And then when their friends join the platform, the user can win different prices. And let's explain from a technical perspective how all of this works. We have this link that gets this unique query parameter applied. And then we are storing this query parameter on our homepage, for example, in a cookie. And then when a new user is trying to sign up, we are checking for that cookie value if it exists and we append it to the right user. Now, all of this is handled by the backend and it's just a simple table with a few fields. So we have the unique ID here, we have the name, email password, and then we have this referred by field. And basically how this works is we are sending to the backend this unique identifier in the URL. And the backend is then checking to whom that identifier belongs and it's adding that user to the backend. All right. So let's jump into WISD and let's set this up. So we already have in our project the create new user request, the login request, and we have the load user request. And I'm currently logged in, so I can just run this request. And you can see here that I get this unique identifier from the user that's currently logged in. And I get also this number of referrals. All right. Now let's work with these responses and let's set up our frontend. The first thing we're going to do here is we're going to populate this input field with the unique link that the user gets. To do that, we're going to go to actions. And here I'm going to call this action set input link. In this case, I'm going to apply to the referral program folder, which I created earlier. And here I'm going to select the input. All right. On the configuration, I'm going to set set input value. And the value is going to be the page where I want the users to go. In this case, it's this homepage over here. And then I'm going to add this query parameter at the end. So I'm going to write question mark. And we're going to call the parameter ref. Okay. Equals. And now here, I can simply select the unique identifier from the user. We have this in our load user request and we have this UUID field. Perfect. And this is this field over here that we have in our user base. If we now refresh the canvas, we can see that we have a unique link here. Perfect. And we also have pins with attribute applied to this button, which simply copies the value to clipboard. Awesome. Now let's set up the logic that we need on the homepage. Perfect. Now let's set up the logic that we need on the homepage. If we open the homepage here, we can go to canvas. And here we can add this ref parameter, which we just had. Under value, I'm going to select this UUID here because this is the same reference that we had there. Perfect. And now what I have to do is I have to go to page data. And here I have to create this ref parameter. So I'm going to go under navigation. I'm going to click on the plus sign. And here I'm going to create a ref parameter. And now if we refresh the canvas, we can see that the ref parameter has this value that we added. Okay, perfect. If we would be on the sign up page, we could simply check for the reference. We could check for the query parameter. But since we are on another page right now, we have to store this value so that the value persists across pages. So what we're going to do here is we're going to store this value in a cookie. So we're going to click here on the plus sign and we're going to create a new cookie. We're going to call it ref. So it's called the same way. And here I'm going to choose the lifetime to be one month. But this is up to you. You can set it maybe to even a year or to as little as a week. Perfect. Now I'm going to go to the load user request, which gets triggered on this page. And here in this request, I'm going to add an after request action. I'm going to set a cookie. This is our ref cookie. And I'm going to set it to our ref query parameter. Now this wouldn't work out of the box because the ref parameter is not always there. If the user came from another source, not from a referral link, then they don't have this ref parameter. So this wouldn't work. So we have to add a condition here. We're going to check if the ref parameter is set. So if the ref parameter has a value, only then will we set this ref cookie to the value of our query parameter. Perfect. Now if we try to run this request again, we can see that our token got stored in the cookie. If we go under page data, now we can see that we have our ref cookie and this unique identifier is being stored here. Perfect. And now if we leave the page and come back to it, this is still going to be stored in the cookie. Awesome. Now let's head over to our sign up page and let's set up the last piece of the puzzle. So here in our sign up request, we have the full name field, the email address, and we have a password field. You can see in our request here that this is exactly what we have under inputs. Now here we need to add a fourth input. If we open our API endpoint here and we go under sign up, we can see that we have also this refer ID. So here we're going to write refer ID and the value is going to be the value of our cookie. There we go. And if this is empty by default, this cookie will be an empty string. But in this case, we want it to be null because this is what our backend is checking for. So we're going to write this and then we're going to add this again here. So if this cookie has a truthy value, we're going to set it to cookie. Otherwise, we're simply going to write null here. Perfect. And now if we create a new user here, we can see in our database that we have the right refer, which is the person that was previously logged in. Now that we know that our setup is working, we can set up the last things in the referral program. The last thing we have to do here is display how many users have been invited. We can also set this progress bar and we can replace this headline. Now, I'm not going to go through all of it. I'm just going to show you how to set the progress bar and the count here. And then with the headline, you can basically follow the same pattern. So let's create an action and write set count. We're going to apply it to our counter. And here under configuration, we're going to choose set text, plain text. And here in our request, we basically get how many users have been referred by this person. In this case, it's zero. Perfect. And now if we refresh the canvas, we can see here friends joined. It's going to say zero. Awesome. Now let's set up this progress bar. If we head over to Webflow, you can see that this progress bar is at 10% width on number one, 45% width at number two, and 80% width at number three. When the user invited three people, we're going to set it to 100% like so. So let's create here an action for that. We're going to write set width. And here we're going to apply it to our progress bar. Under configuration, we're going to choose set style. Here we're going to choose width. And under value, we're going to write an if-else statement. But this one is going to be a little bit more complex than usually. Normally, how we write if-else statements is we write a condition here. And then we check whether if it's true or false. And if we write if it's true, we do this. If it's false, we do something else. But in this case, we're going to write a classical if-else statement because it's going to be easier to read and we have multiple conditions. So we're going to write if, and here we're going to check referrals. So if it's greater than two, we're going to write 100%. Then we're going to write else if equals to, we're going to set it to 45%. Then we're going to have else if again. We can check for one. 10%, and then we're going to have else, which means it's zero. We're going to write here 0%. Okay, perfect. And now if we hit refresh here, we can see that our progress bar is at zero. And if we now add to other users this person as the referrer, we should now have two friends joined via that link. So let's head back to our front end. Let's refresh the canvas. And now we can see two friends joined. Okay, and basically if you wanted to replace the headline based on the number of users that joined, you could do the same thing with the if-else statement. Awesome. And that's how you set up a referral program with Wizd and Zano on the backend. Thank you so much for watching and I'll see you in the next video. Cheers. Microsoft Mechanics www.microsoft.com www.microsoft.com