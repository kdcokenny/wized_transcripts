Hello and welcome to the third video of this series. In this video we're going to learn how to create orders from the cart and then we're going to move to the order pages. So basically we're going to set up the order page for the supplier where all orders that customers placed will be displayed and then we're going to move over to the customer orders where the customer will be able to see his or her orders. Now we also have some additional pages which is this inventory page so we're going to create that as well where the suppliers can update the inventory and then we're going to move over to user management. So basically the supplier will be able to delete customer profiles as well. So we're going to learn today how to build all of this functionality and without any further ado let's jump right into it. As I said we're going to start by building this cart functionality so let's just expand this cart and we're going to add to this button over here we're going to add an action that's going to create an order. Alright so let's start by first creating a new data out action and if we look at our Xano endpoint we can see that we have this orders endpoint. Here we can see that we have under orders we have add orders record. Alright so if we look at this orders endpoint we can see that we have to specify a few inputs here. We have to send the user ID of the user that's currently logged in. We have to send ordered products so these are the products that have been ordered and we can see here that we have also a status by default that's going to be processing. Alright so if we look at the response from this endpoint we are basically just sending here the user ID let's say 44 and basically inside of these brackets will be all of the products that we want to send and when this request is triggered a new order will be created. Alright let's go back to Wiz now and let's set this up and running. So we're going to go to data out and we're going to create a new request. Here I'm going to call it create order and under app I'm going to select Xano. Now under endpoint we're going to send it to this endpoint. We can see it's a post request and we're going to send it to orders. Alright now we have to specify the inputs. We can see that the status gets added automatically we only have to provide the user ID and the ordered products. So let's start with user ID. And here we're simply going to add the ID of the currently logged in user. In this case we have this load user request and we're going to select this ID field perfect. Now we have to add also ordered products. Now when you do these things it's important to check that you don't have a typo anywhere so these values really need to match. And under value we're going to send the items from the cart. So we have basically load cart and here we can simply select the items. And also it needs to be an authorized request so we're going to add our cookie here. Perfect and now let's see if this is working. If we run this request we can see that an order has been created. And if we open Xano now and we look at our database we can see that a new order has been created here as well. So this is the order that was just created. Now in this case it's been created by the admin but normally orders are created by customers. Perfect now that the users can create orders we need to have a page where these orders will be displayed. And luckily we already have the page we just need to build the functionality. So let's go to all orders and let's set this up and running. Here we basically just need to load orders and that we're going to do by building first a data in request because just like we're getting products and loading the cart we also need to load these orders. So let's click on the plus sign here and we can call it load orders. And the endpoint is also orders in this case. I can show you that in Xano quickly. Here we have this endpoint called query all orders records and I'll explain how this works in a little bit but we're going to use this same endpoint in two places. So one request is going to handle the customer side and the supplier side. I'm going to get to that in a little bit. So it's going to be a get request and here under authorization it also needs to be an authorized request so we're going to select our token. This endpoint is a little bit more complex on the back end so I'll just quickly walk you through it. Basically this endpoint checks whether the currently logged in user is a customer or a supplier and then if the user is a customer it will respond with only the orders of that customer and if the user is a supplier it will send a list with all orders that have been placed by customers. And this is this logic right here. I'm not going to go into details here but this is all you have to know for now. So I can just quickly demonstrate it to you. You can see here that right now if we're logged in as a customer. This is a customer profile and I run this request I can see only two orders or three orders that have been placed by this customer and now if I go in to let's say another customer profile that doesn't have any orders it should be empty and if I go to the admin if I add here an admin token let's say from the user that we have currently logged in in our account and I run this request you're going to see that it displays all of the orders that have been placed by all of the customers and we can see here the user ID of each customer that placed this order. Now that we know how the endpoint works let's just build this request. So we have already the token, we have the method and we don't need to provide anything else to that. Basically if we run this request it's going to display all of the orders because the user that's currently logged in is a supplier. And there we have it. We have the same data that we have in our Xano endpoint. Perfect. Now all we have to do is set up a trigger. Here on this page I basically added the same attributes as I did on the customers orders page so we have to build all of our logic only once and it will be executed on both pages so the same actions will be applied because they're targeting attributes on the customer page and the supplier page. So let's add our trigger and here we're going to trigger this on page load and we're going to check if this page contains this attribute called order items. Here we have it. All orders item. Awesome. Now if we look at our page data and we refresh this page we can see that this request here gets executed immediately. There we go. Now we just have to render and display that data on our page. So let's go to actions and I created already an orders folder so let's add some actions to that folder. The first action we have to add is our render list action. We're going to add it to our orders folder and we're going to apply it to the orders item. Perfect. Under configuration we're going to choose render list and we have to specify the array from which this list is going to be rendered. And here if we expand our request we can see that we have this first array over here which we're going to select. Now just like we did in our previous tutorials we have to specify a variable for indexing and we're going to specify this i variable. Now this is something I created in a previous tutorial but basically under page data you can create new variables. And if we refresh the canvas now we can see that a bunch of items get rendered. Now this is the same thing as CMS collections. Basically when you render a list from a CMS collection all of the items will be the same but then you have to replace these values inside. So let's start by adding some actions that will replace these values. We're going to start with the ID. We're going to go from left to right. So first let's create a new action and we're going to call it set ID. We're going to add it to the same folder and here we're going to apply it to the orders ID item. Under configuration we're going to set the text, plain text and we're going to set it to the ID of the item. So here we can find the ID field in our request and then we have to replace this number zero with our iterator variable. Perfect. And now we also want to prepend this hash symbol over here so all we have to do is before these squiggly brackets we simply have to add this value. Okay and now if we click on this input field we can see basically what the output will be. Now the preview is always for the first item so be aware of that. Now if we refresh the canvas we can see that this value gets changed. Perfect. Now let's set the date. We're going to create a new action and I'm going to call it set date. I'm going to apply it to the date item and under configuration I'm going to also set the text and I'm going to set it to plain text. Here under text I'm going to select the created at field and this basically creates a timestamp and we basically want to convert this into a date. So we can look at our cheat sheet and we can see how to do that. In our intelligence center we have this formula cheat sheet and here you have to find format timestamp by local. So we're going to copy this and we're going to head back to our action. Now let's expand this field and let's just paste this text in. So basically you can see that we have some placeholder values inside here and we need to replace this r.7.d created at with our value over here. So let's cut our value out, let's delete these squiggly brackets because we no longer need them and let's paste our value inside here. So you can see that we get this date formatted like this but we don't need all of these. So let's delete this part, make sure to stay inside of the squiggly brackets and let's delete everything that comes before this plus sign. Alright and now let's say we also don't want to display this day, Monday and we don't want to display the time. So all we have to do is we have to delete the values from here. So we're going to delete the hour and we're also going to delete the weekday. Awesome. In this case I'm happy with it so I'm going to hit done and I'm going to refresh the canvas and now you can see that all of the dates get propagated but the problem is that all of the dates show the same date. So there's still one issue that we need to fix. If we open set date and we go to configuration and I expand the text field you can see that we didn't replace this number zero with our iterator variable so we need to do that. We have that on the general and here we have our variables v.i. Also here I have a zero so this creates a typo so like this it's going to work, perfect. Now if we hit refresh you can see that all the dates are displaying correctly. Next we have the status. So let's call this set status. And here we're going to do the same thing. We're going to set the text, plain text and we're going to select this status field. Also we have to replace this value with the iterator variable once again and we're going to hit done. Now here we're also going to do one more thing. Basically we want to display a yellow background if the order is still processing and display a green background if it was fulfilled. So we're going to add one more configuration here. We're going to choose set style and we're going to change the background color. So we're going to select here background color and here we're going to write a conditional statement. So let's expand our load orders here, let's select the status, we're going to replace this index with our variable just like we did before and now we're going to check if it is processing. So we're going to write equals, equals, equals, inside of a string we're going to write processing. I have a typo, okay. And I have another typo, perfect. Alright now we can see that we get a Boolean and it says true. And now let's turn this into a conditional statement. So we're going to add a question mark and this is the condition that needs to evaluate either to true or false and now we're going to add what happens if this is true and what happens if this is false. So if the order is processing we want the background to be yellow. Otherwise we're going to turn it green. Now you can write of course here hex codes and you can add also another status for declined or whatever and add another color but basically the logic is the same. Alright so here we're going to hit done and now if we refresh the canvas we should see basically that all of the orders are currently processing and if we change a value in Zano to let's say fulfilled and if we refresh the canvas we can see that one of the orders is green. Now of course this looks a little bit dark so I'm also going to change the color property. So we're going to choose set style again, here I'm going to select color and here we're going to use this same value over here. We can copy this same condition that we had before, we're just going to change it a little bit. So I'm going to paste this in here and then we want to basically check if the order is processing then we want the color of the text to be black otherwise we want it to be white. Perfect and now if we refresh the canvas we can see here that processing is having the black color applied on the text and this is having white. Awesome perfect we're going somewhere. Now we just have to set the price and the number of items and also we're going to set up this see details action. All right let's create a new action called set price and we're going to do the same thing again we're going to choose price here we're going to configure a set text action and we're going to select plain text and the price can be found all the way here at the bottom of this index zero and we're going to replace this with our iterator variable. And of course you can see here that we get just a number and in this case we want to also prepend the currency symbol. Perfect now let's also set this item count. We're going to apply this to our item count field and under configuration we're going to set the text again. Now here under text we're going to select this field over here ordered products and basically what we want to do here is we want to replace this value with our iterator variable but then we also want to check how many products are inside of this array. So to do that we have to write dot length and now we can see how many items are inside of this array. So basically when you want to check how long an array is all you have to do is write dot length. If I refresh the canvas here you can see the number of items in each order over here. All right now there's one more issue we just have the number we're not saying items so let's expand the action again. Now here we can append the word items and you can see here that we get this string called one items or here it says three items but let's say we wanted to say one item or three items so we want to check the length and if the length is one then we want to say item if the length of this array is more than one we're going to say items. All right so let's look at this data field field and we're going to make this a little bit more complex. So we're going to write here squiggly brackets again and here we're going to write equals equals equals one so if there is one item we're going to write this so the number of items plus and here inside of a string we're going to write item and then we're going to add an else condition with those with a colon and here we're going to write this same thing we're just going to change this to items. Okay items perfect and we also have to add a space here like so and now basically if we close this and we refresh the canvas we can see here that we have one item three items awesome and the last thing we have to do here is we're going to set up the link on this button over here. I won't go into details how exactly this works and what the functionality is because I'll cover that in a separate video but for now I'll just show you.